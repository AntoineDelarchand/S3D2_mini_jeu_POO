require 'bundler'
Bundler.require

require_relative 'lib/game'
require_relative 'lib/player'

puts "
###############################################################################################################################################################################################

                                                        ▒█████   ▄████▄  ▄▄▄█████▓ ▒█████    ▄████  ▒█████   ███▄    █ ▓█████ 
                                                        ▒██▒  ██▒▒██▀ ▀█  ▓  ██▒ ▓▒▒██▒  ██▒ ██▒ ▀█▒▒██▒  ██▒ ██ ▀█   █ ▓█   ▀ 
                                                        ▒██░  ██▒▒▓█    ▄ ▒ ▓██░ ▒░▒██░  ██▒▒██░▄▄▄░▒██░  ██▒▓██  ▀█ ██▒▒███   
                                                        ▒██   ██░▒▓▓▄ ▄██▒░ ▓██▓ ░ ▒██   ██░░▓█  ██▓▒██   ██░▓██▒  ▐▌██▒▒▓█  ▄ 
                                                        ░ ████▓▒░▒ ▓███▀ ░  ▒██▒ ░ ░ ████▓▒░░▒▓███▀▒░ ████▓▒░▒██░   ▓██░░▒████▒
                                                        ░ ▒░▒░▒░ ░ ░▒ ▒  ░  ▒ ░░   ░ ▒░▒░▒░  ░▒   ▒ ░ ▒░▒░▒░ ░ ▒░   ▒ ▒ ░░ ▒░ ░
                                                        ░ ▒ ▒░   ░  ▒       ░      ░ ▒ ▒░   ░   ░   ░ ▒ ▒░ ░ ░░   ░ ▒░ ░ ░  ░
                                                        ░ ░ ░ ▒  ░          ░      ░ ░ ░ ▒  ░ ░   ░ ░ ░ ░ ▒     ░   ░ ░    ░   
                                                        ░ ░  ░ ░ ░                 ░ ░        ░     ░ ░           ░    ░  ░
                                                                ░                                                             
##############################################################################################################################################################################################
"

puts "
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"
puts "                                                      Saisissez votre pseudo (quatre lettre plz ;)) :"
print "                                                      > "
username = gets.chomp
puts "  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"

user = HumanPlayer.new(username)

player1 = Player.new("José")
player2 = Player.new("Rose")

enemies = [player1,player2]

while user.life_points > 0 && (player1.life_points > 0 || player2.life_points > 0)
    puts "
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                      Voici l'état de votre joueur :"


puts "                                                                      #{user.show_state}"

puts ""

puts "                                                                Voici l'état des autres joueurs :"

puts "                                                                      #{player1.show_state}"
puts "                                                                      #{player2.show_state}"
puts "
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"

puts "
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                      Quelle action veux-tu effectuer"

puts "                                                                a - chercher une meilleure arme"
puts "                                                                s - chercher à se soigner"
puts ""
puts "                                                                attaquer un joueur en vue :"
puts "                                                                1 - José a #{player1.life_points} hp !"
puts "                                                                2 - Rose a #{player2.life_points} hp !
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
"
print "                                                                > "
key = gets.chomp

if key == "a"
    user.search_weapon
elsif key == "s"
    user.search_health_pack
elsif key == "1"
    user.attacks(player1)
elsif key == "2"
    user.attacks(player2)
else
    puts "a,s,1 ou 2 !!!"
end

    while key == ["a","s","1","2"]
        puts "
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                            Quelle action veux-tu effectuer"

        puts "                                                                a - chercher une meilleure arme"
        puts "                                                                s - chercher à se soigner"
        puts ""
        puts "                                                                attaquer un joueur en vue :"
        puts "                                                                1 - José a #{player1.life_points} hp !"
        puts "                                                                2 - Rose a #{player2.life_points} hp !
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        "
        print "                                                                > "
        key = gets.chomp       
    end

    puts "
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                            Les autres joueurs attaquent !"
puts "
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"

    if user.life_points > 0 && player1.life_points > 0
        player1.attacks(user)
    elsif user.life_points > 0 && player2.life_points > 0
        player2.attacks(user)
    else
        puts ""
    end

end
puts "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"
puts "                                                                              La Partie est finie"
puts "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"

if user.life_points > 0 && (player1.life_points <= 0 && player2.life_points <= 0)
    puts "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                            
                                                            ██╗   ██╗ ██████╗ ██╗   ██╗    ██╗    ██╗ ██████╗ ███╗   ██╗    ██╗
                                                            ╚██╗ ██╔╝██╔═══██╗██║   ██║    ██║    ██║██╔═══██╗████╗  ██║    ██║
                                                             ╚████╔╝ ██║   ██║██║   ██║    ██║ █╗ ██║██║   ██║██╔██╗ ██║    ██║
                                                              ╚██╔╝  ██║   ██║██║   ██║    ██║███╗██║██║   ██║██║╚██╗██║    ╚═╝
                                                               ██║   ╚██████╔╝╚██████╔╝    ╚███╔███╔╝╚██████╔╝██║ ╚████║    ██╗
                                                               ╚═╝    ╚═════╝  ╚═════╝      ╚══╝╚══╝  ╚═════╝ ╚═╝  ╚═══╝    ╚═╝
                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"
else
    puts "-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

                                                            ██╗   ██╗ ██████╗ ██╗   ██╗    ██╗      ██████╗ ███████╗███████╗    ██╗
                                                            ╚██╗ ██╔╝██╔═══██╗██║   ██║    ██║     ██╔═══██╗██╔════╝██╔════╝    ██║
                                                             ╚████╔╝ ██║   ██║██║   ██║    ██║     ██║   ██║███████╗█████╗      ██║
                                                              ╚██╔╝  ██║   ██║██║   ██║    ██║     ██║   ██║╚════██║██╔══╝      ╚═╝
                                                               ██║   ╚██████╔╝╚██████╔╝    ███████╗╚██████╔╝███████║███████╗    ██╗
                                                               ╚═╝    ╚═════╝  ╚═════╝     ╚══════╝ ╚═════╝ ╚══════╝╚══════╝    ╚═╝
                                                                                                                                
                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"
end